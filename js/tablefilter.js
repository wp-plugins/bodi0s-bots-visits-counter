/*====================================================
	- HTML Table Filter Generator v1.6
	- By Max Guglielmi
	- mguglielmi.free.fr/scripts/TableFilter/?l=en
	- please do not change this comment
	- don't forget to give some credit... it's always
	good for the author
	- Special credit to Cedric Wartel and 
	cnx.claude@free.fr for contribution and 
	inspiration
=====================================================*/

var TblId,SearchFlt,SlcArgs;TblId=new Array(),SlcArgs=new Array();function setFilterGrid(k){var g=grabEBI(k);var j,f;if(g!=null&&g.nodeName.toLowerCase()=="table"){if(arguments.length>1){for(var c=0;c<arguments.length;c++){var b=typeof arguments[c];switch(b.toLowerCase()){case"number":j=arguments[c];break;case"object":f=arguments[c];break}}}j==undefined?j=2:j=(j+2);var d=getCellsNb(k,j);g.tf_ncells=d;if(g.tf_ref_row==undefined){g.tf_ref_row=j}g.tf_Obj=f;if(!hasGrid(k)){AddGrid(k)}}}function AddGrid(L){TblId.push(L);var T=grabEBI(L);var ae=T.tf_Obj,Y=T.tf_ncells;var G,b,ah,F,I;var A,Z,S;var o,B,z,H;var Q,af,D,ai;var k,M,g,p;var v,C,E;ae!=undefined&&ae.grid==false?b=false:b=true;ae!=undefined&&ae.btn==true?ah=true:ah=false;ae!=undefined&&ae.btn_text!=undefined?F=ae.btn_text:F="go";ae!=undefined&&ae.enter_key==false?I=false:I=true;ae!=undefined&&ae.mod_filter_fn?A=true:A=false;ae!=undefined&&ae.display_all_text!=undefined?Z=ae.display_all_text:Z="";ae!=undefined&&ae.on_change==false?S=false:S=true;ae!=undefined&&ae.rows_counter==true?o=true:o=false;ae!=undefined&&ae.rows_counter_text!=undefined?B=ae.rows_counter_text:B="Displayed rows: ";ae!=undefined&&ae.btn_reset==true?z=true:z=false;ae!=undefined&&ae.btn_reset_text!=undefined?H=ae.btn_reset_text:H="Reset";ae!=undefined&&ae.sort_select==true?Q=true:Q=false;ae!=undefined&&ae.paging==true?af=true:af=false;ae!=undefined&&ae.paging_length!=undefined?D=ae.paging_length:D=10;ae!=undefined&&ae.loader==true?ai=true:ai=false;ae!=undefined&&ae.loader_text!=undefined?k=ae.loader_text:k="Loading...";ae!=undefined&&ae.exact_match==true?M=true:M=false;ae!=undefined&&ae.alternate_rows==true?g=true:g=false;ae!=undefined&&ae.col_operation?p=true:p=false;ae!=undefined&&ae.rows_always_visible?v=true:v=false;ae!=undefined&&ae.col_width?C=true:C=false;ae!=undefined&&ae.bind_script?E=true:E=false;T.tf_fltGrid=b;T.tf_displayBtn=ah;T.tf_btnText=F;T.tf_enterKey=I;T.tf_isModfilter_fn=A;T.tf_display_allText=Z;T.tf_on_slcChange=S;T.tf_rowsCounter=o;T.tf_rowsCounter_text=B;T.tf_btnReset=z;T.tf_btnReset_text=H;T.tf_sortSlc=Q;T.tf_displayPaging=af;T.tf_pagingLength=D;T.tf_displayLoader=ai;T.tf_loadText=k;T.tf_exactMatch=M;T.tf_alternateBgs=g;T.tf_startPagingRow=0;if(A){T.tf_modfilter_fn=ae.mod_filter_fn}if(b){var c=T.insertRow(0);c.className="fltrow";for(var ac=0;ac<Y;ac++){var W=c.insertCell(ac);ac==Y-1&&ah==true?G="flt_s":G="flt";if(ae==undefined||ae["col_"+ac]==undefined||ae["col_"+ac]=="none"){var r;(ae==undefined||ae["col_"+ac]==undefined)?r="text":r="hidden";var R=createElm("input",["id","flt"+ac+"_"+L],["type",r],["class",G]);R.className=G;W.appendChild(R);if(I){R.onkeypress=DetectKey}}else{if(ae["col_"+ac]=="select"){var u=createElm("select",["id","flt"+ac+"_"+L],["class",G]);u.className=G;W.appendChild(u);PopulateOptions(L,ac);if(af){var V=new Array();V.push(L);V.push(ac);V.push(Y);V.push(Z);V.push(Q);V.push(af);SlcArgs.push(V)}if(I){u.onkeypress=DetectKey}if(S){(!A)?u.onchange=function(){Filter(L)}:u.onchange=ae.mod_filter_fn}}}if(ac==Y-1&&ah==true){var J=createElm("input",["id","btn"+ac+"_"+L],["type","button"],["value",F],["class","btnflt"]);J.className="btnflt";W.appendChild(J);(!A)?J.onclick=function(){Filter(L)}:J.onclick=ae.mod_filter_fn}}}if(o||z||af||ai){var aa=createElm("div",["id","inf_"+L],["class","inf"]);aa.className="inf";T.parentNode.insertBefore(aa,T);if(o){var O;var m=createElm("div",["id","ldiv_"+L]);o?m.className="ldiv":m.style.display="none";af?O=D:O=getRowsNb(L);var s=createElm("span",["id","totrows_span_"+L],["class","tot"]);s.className="tot";s.appendChild(createText(O));var x=createText(B);m.appendChild(x);m.appendChild(s);aa.appendChild(m)}if(ai){var ag=createElm("div",["id","load_"+L],["class","loader"]);ag.className="loader";ag.style.display="none";ag.appendChild(createText(k));aa.appendChild(ag)}if(af){var K=createElm("div",["id","mdiv_"+L]);af?K.className="mdiv":K.style.display="none";aa.appendChild(K);var P=T.tf_ref_row;var q=grabTag(T,"tr");var U=q.length;var X=Math.ceil((U-P)/D);var l=createElm("select",["id","slcPages_"+L]);l.onchange=function(){if(ai){showLoader(L,"")}T.tf_startPagingRow=this.value;GroupByPage(L);if(ai){showLoader(L,"none")}};var d=createElm("span",["id","pgspan_"+L]);grabEBI("mdiv_"+L).appendChild(createText(" Page "));grabEBI("mdiv_"+L).appendChild(l);grabEBI("mdiv_"+L).appendChild(createText(" of "));d.appendChild(createText(X+" "));grabEBI("mdiv_"+L).appendChild(d);for(var ab=P;ab<U;ab++){q[ab].setAttribute("validRow","true")}setPagingInfo(L);if(ai){showLoader(L,"none")}}if(z&&b){var N=createElm("div",["id","reset_"+L]);z?N.className="rdiv":N.style.display="none";var ad=createElm("a",["href","javascript:clearFilters('"+L+"');Filter('"+L+"');"]);ad.appendChild(createText(H));N.appendChild(ad);aa.appendChild(N)}}if(C){T.tf_colWidth=ae.col_width;setColWidths(L)}if(g&&!af){setAlternateRows(L)}if(p){T.tf_colOperation=ae.col_operation;setColOperation(L)}if(v){T.tf_rowVisibility=ae.rows_always_visible;if(af){setVisibleRows(L)}}if(E){T.tf_bindScript=ae.bind_script;if(T.tf_bindScript!=undefined&&T.tf_bindScript.target_fn!=undefined){T.tf_bindScript.target_fn.call(null,L)}}}function PopulateOptions(r,l){var o=grabEBI(r);var u=o.tf_ncells,A=o.tf_display_allText;var z=o.tf_sortSlc,d=o.tf_displayPaging;var n=o.tf_ref_row;var f=grabTag(o,"tr");var q=new Array();var p=0;var c=new Option(A,"",false,false);grabEBI("flt"+l+"_"+r).options[p]=c;for(var v=n;v<f.length;v++){var b=getChildElms(f[v]).childNodes;var s=b.length;var B=f[v].getAttribute("paging");if(s==u){for(var x=0;x<s;x++){if(l==x){var m=getCellText(b[x]);var g=false;for(w in q){if(m==q[w]){g=true}}if(!g){q.push(m)}}}}}if(z){q.sort()}for(y in q){p++;var c=new Option(q[y],q[y],false,false);grabEBI("flt"+l+"_"+r).options[p]=c}}function Filter(q){showLoader(q,"");SearchFlt=getFilters(q);var o=grabEBI(q);o.tf_Obj!=undefined?fprops=o.tf_Obj:fprops=new Array();var B=new Array();var s=getCellsNb(q);var f=getRowsNb(q),v=0;var u=o.tf_exactMatch;var b=o.tf_displayPaging;for(var C=0;C<SearchFlt.length;C++){B.push((grabEBI(SearchFlt[C]).value).toLowerCase())}var n=o.tf_ref_row;var g=grabTag(o,"tr");for(var x=n;x<g.length;x++){if(g[x].style.display=="none"){g[x].style.display=""}var d=getChildElms(g[x]).childNodes;var r=d.length;if(r==s){var E=new Array();var p=new Array();var c=true;for(var A=0;A<r;A++){var m=getCellText(d[A]).toLowerCase();E.push(m);if(B[A]!=""){var D=parseFloat(m);if(/<=/.test(B[A])&&!isNaN(D)){D<=parseFloat(B[A].replace(/<=/,""))?p[A]=true:p[A]=false}else{if(/>=/.test(B[A])&&!isNaN(D)){D>=parseFloat(B[A].replace(/>=/,""))?p[A]=true:p[A]=false}else{if(/</.test(B[A])&&!isNaN(D)){D<parseFloat(B[A].replace(/</,""))?p[A]=true:p[A]=false}else{if(/>/.test(B[A])&&!isNaN(D)){D>parseFloat(B[A].replace(/>/,""))?p[A]=true:p[A]=false}else{var F;if(u||fprops["col_"+A]=="select"){F=new RegExp("(^)"+regexpEscape(B[A])+"($)","gi")}else{F=new RegExp(regexpEscape(B[A]),"gi")}p[A]=F.test(m)}}}}}}for(var l=0;l<s;l++){if(B[l]!=""&&!p[l]){c=false}}}if(!c){g[x].style.display="none";v++;if(b){g[x].setAttribute("validRow","false")}}else{g[x].style.display="";if(b){g[x].setAttribute("validRow","true")}}}o.tf_nRows=parseInt(getRowsNb(q))-v;if(!b){applyFilterProps(q)}if(b){o.tf_startPagingRow=0;setPagingInfo(q)}}function setPagingInfo(c){var q=grabEBI(c);var p=parseInt(q.tf_ref_row);var g=q.tf_pagingLength;var r=grabTag(q,"tr");var n=grabEBI("mdiv_"+c);var f=grabEBI("slcPages_"+c);var d=grabEBI("pgspan_"+c);var l=0;for(var k=p;k<r.length;k++){if(r[k].getAttribute("validRow")=="true"){l++}}var m=Math.ceil(l/g);d.innerHTML=m;f.innerHTML="";if(m>0){n.style.visibility="visible";for(var o=0;o<m;o++){var b=new Option((o+1),o*g,false,false);f.options[o]=b}}else{n.style.visibility="hidden"}GroupByPage(c)}function GroupByPage(c){showLoader(c,"");var o=grabEBI(c);var n=parseInt(o.tf_ref_row);var g=parseInt(o.tf_pagingLength);var d=parseInt(o.tf_startPagingRow);var f=d+g;var p=grabTag(o,"tr");var l=0;var b=new Array();for(var k=n;k<p.length;k++){var m=p[k].getAttribute("validRow");if(m=="true"){b.push(k)}}for(h=0;h<b.length;h++){if(h>=d&&h<f){l++;p[b[h]].style.display=""}else{p[b[h]].style.display="none"}}o.tf_nRows=parseInt(l);applyFilterProps(c)}function applyFilterProps(j){t=grabEBI(j);var c=t.tf_rowsCounter;var d=t.tf_nRows;var b=t.tf_rowVisibility;var f=t.tf_alternateBgs;var g=t.tf_colOperation;if(c){showRowsCounter(j,parseInt(d))}if(b){setVisibleRows(j)}if(f){setAlternateRows(j)}if(g){setColOperation(j)}showLoader(j,"none")}function hasGrid(d){var c=false,b=grabEBI(d);if(b!=null&&b.nodeName.toLowerCase()=="table"){for(i in TblId){if(d==TblId[i]){c=true}}}return c}function getCellsNb(g,d){var b=grabEBI(g);var c;if(d==undefined){c=grabTag(b,"tr")[0]}else{c=grabTag(b,"tr")[d]}var f=getChildElms(c);return f.childNodes.length}function getRowsNb(f){var c=grabEBI(f);var d=c.tf_ref_row;var b=grabTag(c,"tr").length;return parseInt(b-d)}function getFilters(j){var d=new Array();var c=grabEBI(j);var f=grabTag(c,"tr")[0];var g=f.childNodes;if(c.tf_fltGrid){for(var b=0;b<g.length;b++){d.push(g[b].firstChild.getAttribute("id"))}}return d}function clearFilters(b){SearchFlt=getFilters(b);for(i in SearchFlt){grabEBI(SearchFlt[i]).value=""}}function showLoader(d,c){var b=grabEBI("load_"+d);if(b!=null&&c=="none"){setTimeout("grabEBI('load_"+d+"').style.display = '"+c+"'",150)}else{if(b!=null&&c!="none"){b.style.display=c}}}function showRowsCounter(d,b){var c=grabEBI("totrows_span_"+d);if(c!=null&&c.nodeName.toLowerCase()=="span"){c.innerHTML=b}}function getChildElms(f){if(f.nodeType==1){var d=f.childNodes;for(var b=0;b<d.length;b++){var c=d[b];if(c.nodeType==3){f.removeChild(c)}}return f}}function getCellText(g){var c="";var f=g.childNodes;for(var b=0;b<f.length;b++){var d=f[b];if(d.nodeType==3){c+=d.data}else{c+=getCellText(d)}}return c}function getColValues(c,b,l){var r=grabEBI(c);var s=grabTag(r,"tr");var k=s.length;var p=parseInt(r.tf_ref_row);var o=getCellsNb(c,p);var n=new Array();for(var g=p;g<k;g++){var q=getChildElms(s[g]).childNodes;var d=q.length;if(d==o){for(var f=0;f<d;f++){if(f==b&&s[g].style.display==""){var m=getCellText(q[f]).toLowerCase();(l)?n.push(parseFloat(m)):n.push(m)}}}}return n}function setColWidths(m){if(hasGrid(m)){var d=grabEBI(m);d.style.tableLayout="fixed";var g=d.tf_colWidth;var l=parseInt(d.tf_ref_row);var j=grabTag(d,"tr")[0];var f=getCellsNb(m,l);for(var c=0;c<g.length;c++){for(var b=0;b<f;b++){cell=j.childNodes[b];if(b==c){cell.style.width=g[c]}}}}}function setVisibleRows(k){if(hasGrid(k)){var c=grabEBI(k);var g=grabTag(c,"tr");var d=g.length;var j=c.tf_displayPaging;var f=c.tf_rowVisibility;for(var b=0;b<f.length;b++){if(f[b]<=d){if(j){g[f[b]].setAttribute("validRow","true")}g[f[b]].style.display=""}}}}function setAlternateRows(m){if(hasGrid(m)){var f=grabEBI(m);var k=grabTag(f,"tr");var g=k.length;var l=parseInt(f.tf_ref_row);var b=new Array();for(var d=l;d<g;d++){if(k[d].style.display==""){b.push(d)}}for(var c=0;c<b.length;c++){(c%2==0)?k[b[c]].className="even":k[b[c]].className="odd"}}}function setColOperation(r){if(hasGrid(r)){var p=grabEBI(r);var D=p.tf_colOperation.id;var q=p.tf_colOperation.col;var m=p.tf_colOperation.operation;var c=p.tf_colOperation.write_method;var B=2;if((typeof D).toLowerCase()=="object"&&(typeof q).toLowerCase()=="object"&&(typeof m).toLowerCase()=="object"){var d=grabTag(p,"tr");var f=d.length;var n=parseInt(p.tf_ref_row);var s=getCellsNb(r,n);var b=new Array();for(var v=0;v<q.length;v++){b.push(getColValues(r,q[v],true))}for(var A=0;A<b.length;A++){var l=0,u=0;for(var x=0;x<b[A].length;x++){var z=b[A][x];if(!isNaN(z)){switch(m[A].toLowerCase()){case"sum":l+=parseFloat(z);break;case"mean":u++;l+=parseFloat(z);break}}}switch(m[A].toLowerCase()){case"mean":l=l/u;break}if(c!=undefined&&(typeof c).toLowerCase()=="object"){l=l.toFixed(B);if(grabEBI(D[A])!=undefined){switch(c[A].toLowerCase()){case"innerhtml":grabEBI(D[A]).innerHTML=l;break;case"setvalue":grabEBI(D[A]).value=l;break;case"createtextnode":var g=grabEBI(D[A]).firstChild;var o=createText(l);grabEBI(D[A]).replaceChild(o,g);break}}}else{try{grabEBI(D[A]).innerHTML=l.toFixed(B)}catch(C){}}}}}}function grabEBI(b){return document.getElementById(b)}function grabTag(c,b){return c.getElementsByTagName(b)}function regexpEscape(b){function c(d){a=new RegExp("\\"+d,"g");b=b.replace(a,"\\"+d)}chars=new Array("\\","[","^","$",".","|","?","*","+","(",")");for(e in chars){c(chars[e])}return b}function createElm(f){var d=document.createElement(f);if(arguments.length>1){for(var c=0;c<arguments.length;c++){var b=typeof arguments[c];switch(b.toLowerCase()){case"object":if(arguments[c].length==2){d.setAttribute(arguments[c][0],arguments[c][1])}break}}}return d}function createText(b){return document.createTextNode(b)}function DetectKey(j){var b=(j)?j:(window.event)?window.event:null;if(b){var d=(b.charCode)?b.charCode:((b.keyCode)?b.keyCode:((b.which)?b.which:0));if(d=="13"){var l,f,c,g,k;l=this.getAttribute("id");f=this.getAttribute("id").split("_")[0];c=l.substring(f.length+1,l.length);t=grabEBI(c);(t.tf_isModfilter_fn)?t.tf_modfilter_fn.call():Filter(c)}}}function importScript(k,c){var j=false;var b=grabTag(document,"script");for(var f=0;f<b.length;f++){if(b[f].src.match(c)){j=true;break}}if(!j){var d=grabTag(document,"head")[0];var g=createElm("script",["id",k],["type","text/javascript"],["src",c]);d.appendChild(g)}}function TF_GetFilterIds(){try{return TblId}catch(b){alert("TF_GetFilterIds() fn: could not retrieve any ids")}}function TF_HasGrid(b){return hasGrid(b)}function TF_GetFilters(d){try{var b=getFilters(d);return b}catch(c){alert("TF_GetFilters() fn: table id not found")}}function TF_GetStartRow(d){try{var b=grabEBI(d);return b.tf_ref_row}catch(c){alert("TF_GetStartRow() fn: table id not found")}}function TF_GetColValues(d,c,b){if(hasGrid(d)){return getColValues(d,c,b)}else{alert("TF_GetColValues() fn: table id not found")}}function TF_Filter(c){var b=grabEBI(c);if(TF_HasGrid(c)){Filter(c)}else{alert("TF_Filter() fn: table id not found")}}function TF_RemoveFilterGrid(m){if(TF_HasGrid(m)){var f=grabEBI(m);clearFilters(m);if(grabEBI("inf_"+m)!=null){f.parentNode.removeChild(f.previousSibling)}var l=grabTag(f,"tr");for(var d=0;d<l.length;d++){l[d].style.display="";try{if(l[d].hasAttribute("validRow")){l[d].removeAttribute("validRow")}}catch(g){for(var b=0;b<l[d].attributes.length;b++){if(l[d].attributes[b].nodeName.toLowerCase()=="validrow"){l[d].removeAttribute("validRow")}}}}if(f.tf_alternateBgs){for(var c=0;c<l.length;c++){l[c].className=""}}if(f.tf_fltGrid){f.deleteRow(0)}for(i in TblId){if(m==TblId[i]){TblId.splice(i,1)}}}else{alert("TF_RemoveFilterGrid() fn: table id not found")}}function TF_ClearFilters(b){if(TF_HasGrid(b)){clearFilters(b)}else{alert("TF_ClearFilters() fn: table id not found")}}function TF_SetFilterValue(f,b,d){if(TF_HasGrid(f)){var c=getFilters(f);for(i in c){if(i==b){grabEBI(c[i]).value=d}}}else{alert("TF_SetFilterValue() fn: table id not found")}}var colValues=new Array();function setAutoComplete(j){var d=grabEBI(j);var g=d.tf_bindScript;var f=g.name;var c=g.path;b();function b(){var l=TF_GetFilters(j);for(var k=0;k<l.length;k++){if(grabEBI(l[k]).nodeName.toLowerCase()=="input"){colValues.push(getColValues(j,k))}else{colValues.push("")}}try{actb(grabEBI(l[0]),colValues[0])}catch(m){alert(c+" script may not be loaded")}}};